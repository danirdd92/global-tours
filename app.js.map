{"mappings":"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","sources":["public/js/index.js","public/js/mapbox.js","public/js/auth.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js","public/js/review.js","utils/catchAsync.js"],"sourcesContent":["import 'core-js/stable';\nimport 'regenerator-runtime/runtime';\nimport { displayMap } from './mapbox.js';\nimport { auth, logout } from './auth.js';\nimport { updateSettings } from './updateSettings.js';\nimport { bookTour } from './stripe.js';\nimport { starHandler, submitReview, deleteReview } from './review';\nimport { showAlert } from './alerts.js';\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst signupForm = document.querySelector('.form--signup');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.querySelector('#book-tour');\nconst reviewFormStars = document.querySelectorAll('.reviews__star--rating');\nconst reviewForm = document.querySelector('.form--review');\nconst deleteReviewBtn = document.querySelectorAll('.delete-icon');\n\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    auth('login', {\n      email: email,\n      password: password,\n    });\n  });\n}\n\nif (signupForm) {\n  signupForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const name = document.querySelector('#name').value;\n    const email = document.querySelector('#email').value;\n    const password = document.querySelector('#password').value;\n    const passwordConfirm = document.querySelector('#password-confirm').value;\n\n    auth('signup', {\n      name: name,\n      email: email,\n      password: password,\n      passwordConfirm: passwordConfirm,\n    });\n  });\n}\n\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\nif (userDataForm)\n  userDataForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n    updateSettings(form, 'data');\n  });\n\nif (userPasswordForm)\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      'password'\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n\nif (bookBtn) {\n  bookBtn.addEventListener('click', async (e) => {\n    bookBtn.textContent = 'Processing...';\n    const tourID = e.target.dataset.tourId;\n    await bookTour(tourID);\n    bookBtn.textContent = 'Book Now';\n  });\n}\n\nif (reviewFormStars) {\n  starHandler();\n}\n\nif (reviewForm) {\n  reviewForm.addEventListener('submit', async (e) => {\n    try {\n      e.preventDefault();\n      const { tour, user, rating } =\n        document.querySelector('.review__ratings').dataset;\n      const review = document.querySelector('#review-text').value;\n\n      await submitReview({\n        tour: tour,\n        user: user,\n        rating: rating,\n        review: review,\n      });\n\n      document.querySelector('.review').remove();\n    } catch (err) {\n      if (err.message === 'Please provide a rating!')\n        return showAlert('error', 'Please provide a rating!');\n      showAlert('error', err.response.data.message);\n    }\n  });\n}\n\nif (deleteReviewBtn) {\n  deleteReviewBtn.forEach((btn) => {\n    btn.addEventListener('click', async (e) => {\n      const { reviewId } = e.target.dataset;\n      e.target\n        .closest('.reviews-card')\n        .querySelector('.deleting')\n        .classList.add('active');\n      await deleteReview(reviewId);\n      e.target.closest('.reviews-card').remove();\n    });\n  });\n}\n","export const displayMap = locations => {\n  mapboxgl.accessToken =\n    'pk.eyJ1Ijoiam9uYXNzY2htZWR0bWFubiIsImEiOiJjam54ZmM5N3gwNjAzM3dtZDNxYTVlMnd2In0.ytpI7V7w7cyT1Kq5rT9Z1A';\n\n  var map = new mapboxgl.Map({\n    container: 'map',\n    style: 'mapbox://styles/jonasschmedtmann/cjvi9q8jd04mi1cpgmg7ev3dy',\n    scrollZoom: false\n    // center: [-118.113491, 34.111745],\n    // zoom: 10,\n    // interactive: false\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach(loc => {\n    // Create marker\n    const el = document.createElement('div');\n    el.className = 'marker';\n\n    // Add marker\n    new mapboxgl.Marker({\n      element: el,\n      anchor: 'bottom'\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add popup\n    new mapboxgl.Popup({\n      offset: 30\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n      .addTo(map);\n\n    // Extend map bounds to include current location\n    bounds.extend(loc.coordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      bottom: 150,\n      left: 100,\n      right: 100\n    }\n  });\n};\n","import axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const auth = async (type, data) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: `/api/v1/users/${type === 'login' ? 'login' : 'signup'}`,\n      data: data\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully!');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    let msg = err.response.data.message;\n    if (err.response.data.message.includes('User validation failed: passwordConfirm')) msg = 'Your passwords does not match!';\n    showAlert('error', msg);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/users/logout'\n    });\n    if ((res.data.status = 'success')) location.reload();\n  } catch (err) {\n    showAlert('error', 'Error logging out! Try again.');\n  }\n};\n","export const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","import axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/users/updateMyPassword'\n        : '/api/v1/users/updateMe';\n\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};","import axios from 'axios';\nimport { showAlert } from './alerts';\n\nconst stripe = Stripe('pk_test_51Iw5YUSCycbhEIix2Dycsst4GDMcrfShWRYXhISxlt5Y4vpQdmmfGOJB7R1VxhlnIWXBHxNbchzw2M4rPp4CWg8X00ewLYIx44');\n\nexport const bookTour = async tourID => {\n  try {\n    // 1) Get the sesssion from the server\n    const session = await axios({\n      method: 'GET',\n      url: `/api/v1/bookings/checkout-session/${tourID}`\n    });\n\n    // 2) Create checkout form + charge the credit card\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id\n    });\n\n  } catch (err) {\n    showAlert('error', 'Something went wrong');\n  }\n};\n","import axios from 'axios';\nimport catchAsync from '../../utils/catchAsync';\nimport { showAlert } from './alerts';\n\nexport const starHandler = () => {\n  const reviewFormStars = document.querySelectorAll('.reviews__star--rating');\n\n  return reviewFormStars.forEach(reviewStar => {\n\n    reviewStar.addEventListener('click', () => {\n      const id = reviewStar.dataset.id;\n\n      reviewFormStars.forEach(star => {\n        star.classList.add('reviews__star--inactive');\n        star.classList.remove('reviews__star--active');\n        if (star.dataset.id <= id) {\n          star.classList.remove('reviews__star--inactive');\n          star.classList.add('reviews__star--active');\n        }\n      });\n\n      document.querySelector('.review__ratings').dataset.rating = id;\n    });\n  });\n};\n\nexport const submitReview = async data => {\n  try {\n    if (data.rating <= 0) throw new Error('Please provide a rating!');\n\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/reviews',\n      data: data\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Review submitted successfully!');\n      setTimeout(() => location.reload(), 1000);\n    }\n\n  } catch (err) {\n    throw err;\n  }\n};\n\nexport const deleteReview = async reviewID => {\n  try {\n    const res = await axios({\n      method: 'DELETE',\n      url: `/api/v1/reviews/${reviewID}`\n    });\n\n    if (res.data === '') showAlert('success', 'Review deleted successfully!');\n\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};","module.exports = fn => {\n  return (req, res, next) => {\n    fn(req, res, next).catch(err => next(err));\n  };\n};"],"names":[],"version":3,"file":"app.js.map"}